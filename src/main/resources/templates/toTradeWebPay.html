<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"      xmlns:th="http://www.thymeleaf.org" >
	<head>
		<meta charset="utf-8">
		<meta http-equiv="pragma" content="no-cache">
		<meta http-equiv="cache-control" content="no-cache">
		<meta http-equiv="expires" content="0">
		<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
		<meta http-equiv="description" content="This is my page">
		<title>Payment Demo</title>
		<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
		<style>
			div{
				line-height: 30px;
				padding: 3px;
			}
			input{
				line-height: 25px;
				outline: none;
			}
			.label-title{
				width: 150px;
				text-align: right;
				padding-right: 5px;
			}
			.label-rows{
				display: flex;
				line-height: 30px;
				font-size: 13px;
			}
			.label-panel{
				margin: auto;
				width: 1000px;
				border: 1px #e5e5e5 solid;
				font-weight: bold;
			}
		</style>
	</head>
  
  	<body style="text-align: center;">
		<div class="label-panel">
			<div>
				<div>Payment Demo</div>
			</div>
			 <form action="#" th:action="@{/submit}" method="post">
				 <div class="label-rows">
					 <div class="label-title">App Id:</div>
					 <div><input id="appid" name="appid" style="width: 310px;" value="e21eeacc6c544a56a6c10348b2a8f6e0"></div>
					 <div class="label-title">appKey:</div>
					 <div><input id="appKey" name="appKey" style="width: 310px;" value="d7beb8bf18a840d9bf8a41ee72482b84"></div>
				 </div>
				 <div class="label-rows">
					 <div class="label-title" style="width: 70px;">publickey:</div>
					 <div><textarea id="publickey" name="publickey" rows="6" cols="125">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAncNFXIpcB7hm8oDxzrXcRzoWovfJ0myyGF6PBMFv3HFfLeOBTCmCff9cfqEXGKvdqvXVnVoeVTOkKJOnDT1pmX/6m88ZWSoZLmW07u+pNpH5vm2DclOcpQbRFJZgqLygVgIUYe5QilNGRdn6GvWyO4Tbx/qRntUQPXrWgyIFjImfOdJ0n1m8ujoGC6hoeLfkv4XFJnW1QcRnQHWDo87MYFjVAc+oAQTT0zwuqUwnCH5AzY4dJNq8tMpJNCccjnH9cX/lf/xftgXCllLZqk9+Oios9l0051LdgRQc2M7xT5qSolUhRENtkOTOS0gn39xiSb8yXhZzvtPjkGUCvwBtPwIDAQAB</textarea></div>
				 </div>
				 <div class="label-rows">
					 <div class="label-title">Nonce:</div>
					 <div><input id="nonce" name="nonce" style="width: 310px;" value="ffcc1cea6038447c90cba1ff3866728b"></div>
					 <div class="label-title">Timestamp:</div>
					 <div><input id="timestamp" name="timestamp" style="width: 310px;" value="" onfocus="clearIntervalInstance()" ondblclick="runIntervalInstance()"></div>
				 </div>
				 <div class="label-rows">
					 <div class="label-title">Out Trade No:</div>
					 <div><input id="outTradeNo" name="outTradeNo" style="width: 310px;" value="2021062421280000011"></div>
					 <div class="label-title">Goods Name:</div>
					 <div><input id="subject" name="subject" style="width: 310px;" value="Goods Name"></div>
				 </div>
				 <div class="label-rows">
					 <div class="label-title">Short Code:</div>
					 <div><input id="shortCode" name="shortCode" style="width: 310px;" value="9000"></div>
					 <div class="label-title">Receive Name:</div>
					 <div><input id="receiveName" name="receiveName" style="width: 310px;" value="Org Name"></div>
				 </div>
				 <div class="label-rows">
					 <div class="label-title">Goods Amount:</div>
					 <div><input id="totalAmount" name="totalAmount" style="width: 310px;" value="10"></div>
					 <div class="label-title">Timeout Express:</div>
					 <div><input id="timeoutExpress" name="timeoutExpress" style="width: 310px;" value="30"></div>
				 </div>
				 <div class="label-rows">
					 <div class="label-title">Notify Url:</div>
					 <div><input id="notifyUrl" name="notifyUrl" value="http://www.google.com/notifyUrl" style="width: 500px;"></div>
					 <div class="label-title">&nbsp;</div>
					 <div style="width: 190px">&nbsp;</div>
				 </div>
				 <div class="label-rows">
					 <div class="label-title">Return Url:</div>
					 <div><input id="returnUrl" name="returnUrl" value="http://www.google.com/returnUrl" style="width: 500px;"></div>
					 <div class="label-title">&nbsp;</div>
					 <div style="width: 190px">&nbsp;</div>
				 </div>
				 <div>
				 <input type="submit" value="Submit"><input type="button" onclick="getData()" value="GetData" style="margin-left: 30px;">&nbsp;<input type="button" onclick="clearData()" value="ClearData" style="margin-left: 30px;">
					 <script type="text/javascript">
						 var interval;
						 $(function(){
							 runIntervalInstance();
						 });
						 function runIntervalInstance(){
							 clearIntervalInstance();
							 interval = setInterval(function(){
								 var timestamp = new Date().getTime();
								 $("#timestamp").val(timestamp);
								 $("#nonce").val(uuid());

								 var nowDate = new Date();
								 var year = nowDate.getFullYear();
								 var month = nowDate.getMonth() + 1 < 10 ? "0" + (nowDate.getMonth() + 1)
										 : nowDate.getMonth() + 1;
								 var day = nowDate.getDate() < 10 ? "0" + nowDate.getDate() : nowDate
										 .getDate();
								 var dateStr = year + "" + month + "" + day;

								 $("#outTradeNo").val(dateStr + timestamp);
							 },1000);
						 }
						 function clearIntervalInstance(){
							 clearInterval(interval);
						 }
						 function getData(){
						 	var outTradeNo = $('#outTradeNo').val();
							 var subject = $('#subject').val();
							 var totalAmount = $('#totalAmount').val();
							 var shortCode = $('#shortCode').val();
							 var notifyUrl = $('#notifyUrl').val();
							 var returnUrl = $('#returnUrl').val();
							 var receiveName = $('#receiveName').val();
							 var appid = $('#appid').val();
							 var appKey = $('#appKey').val();
							 var publickey = $('#publickey').val();
							 var timeoutExpress = $('#timeoutExpress').val();
							 var nonce = $('#nonce').val();
							 var timestamp = $('#timestamp').val();
							 $.post("./getData",{
							 	outTradeNo:outTradeNo,
								 subject:subject,
								 totalAmount:totalAmount,
								 shortCode:shortCode,
								 notifyUrl:notifyUrl,
								 returnUrl:returnUrl,
								 receiveName:receiveName,
								 appid:appid,
								 appKey:appKey,
								 publickey:publickey,
								 timeoutExpress:timeoutExpress,
								 nonce:nonce,
								 timestamp:timestamp
							 },function(res){
							 	$("#sgin").text(res.sign);
								 $("#ussd").text(res.ussd);
								 $("#encode").text(res.encode);
							 });
						 }
						 function clearData(){
							 $("#sgin").text("");
							 $("#ussd").text("");
							 $("#encode").text("");
						 }
						 function uuid() {
							 var s = [];
							 var hexDigits = "0123456789abcdef";
							 for (var i = 0; i < 36; i++) {
								 s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
							 }
							 s[14] = "4"; // bits 12-15 of the time_hi_and_version field to 0010
							 s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01
							 s[8] = s[13] = s[18] = s[23] = "-";

							 var uuid = s.join("");
							 return uuid.replace("-","").replace("-","").replace("-","").replace("-","");
						 }
					 </script>
				 </div>
			 </form>
		</div>

		<div class="label-panel" style="border-top: 0px;">
			<form action="#" th:action="@{/getData}" method="post">
				<div class="label-rows">
					<div class="label-title" style="width: 70px;">stringA:</div>
					<div><textarea id="sgin" rows="4" cols="125"></textarea></div>
				</div>
				<div class="label-rows">
					<div class="label-title" style="width: 70px;">ussdjson:</div>
					<div><textarea id="ussd" rows="4" cols="125"></textarea></div>
				</div>
				<div class="label-rows">
					<div class="label-title" style="width: 70px;">postman:</div>
					<div><textarea id="encode" rows="11" cols="125"></textarea></div>
				</div>
			</form>
		</div>
	</body>
</html>
